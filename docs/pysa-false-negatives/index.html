<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8CK1L365DB"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-8CK1L365DB",{})</script>
<script src="https://buttons.github.io/buttons.js"></script><title data-react-helmet="true">Debugging False Negatives | Pyre</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://pyre-check.org/img/docusaurus.png"><meta data-react-helmet="true" name="twitter:image" content="https://pyre-check.org/img/docusaurus.png"><meta data-react-helmet="true" property="og:url" content="https://pyre-check.org/docs/pysa-false-negatives"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Debugging False Negatives | Pyre"><meta data-react-helmet="true" name="description" content="False Negatives occur when there is a legitimate flow of tainted data from a"><meta data-react-helmet="true" property="og:description" content="False Negatives occur when there is a legitimate flow of tainted data from a"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://pyre-check.org/docs/pysa-false-negatives"><link data-react-helmet="true" rel="alternate" href="https://pyre-check.org/docs/pysa-false-negatives" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://pyre-check.org/docs/pysa-false-negatives" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.88387463.css">
<link rel="preload" href="/assets/js/runtime~main.6a08a8ce.js" as="script">
<link rel="preload" href="/assets/js/main.ff581f58.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/integrated_logo_light.png" alt="Pyre Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/integrated_logo_light.png" alt="Pyre Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link">Documentation</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/getting-started">Type Checking (Pyre)</a></li><li><a class="dropdown__link" href="/docs/pysa-basics">Static Analysis (Pysa)</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/pyre-check" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/pysa-quickstart">Quickstart</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">How Pysa Works</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/pysa-running">Running Pysa</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Scaling Beyond Individual Models</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Development Tips</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/pysa-false-negatives">Debugging False Negatives</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pysa-coverage">Coverage Increasing Strategies</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pysa-tips">General Tips</a></li></ul></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/static-analysis-post-processor">Static Analysis Processor</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Warning Codes</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/pysa-additional-resources">Additional Resources</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/pysa-explore">Exploring Taint Models Interactively</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_1lV3"><div class="docItemContainer_zt2Y"><article><header><h1 class="docTitle_1y8q">Debugging False Negatives</h1></header><div class="markdown"><p>False Negatives occur when there is a legitimate flow of tainted data from a
source to a sink, but Pysa fails to catch it.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="common-causes-of-false-negatives"></a>Common Causes of False Negatives<a class="hash-link" href="#common-causes-of-false-negatives" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="missing-type-information"></a>Missing Type Information<a class="hash-link" href="#missing-type-information" title="Direct link to heading">#</a></h3><p>Pysa relies on type information from Pyre to identify sources and sinks, and to
build the call graph needed to follow the propagation of taint between the two.
Just because type information is available <em>somewhere</em> in the code, does not
mean Pyre will know the type of an object in the exact place where Pysa needs
it. See the documentation on <a href="/docs/pysa-coverage">Coverage Increasing
Strategies</a> for tips on how to increase type
coverage. The following examples demonstrate how lost type information leads to
lost flows.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="missing-sourcessinks"></a>Missing Sources/Sinks<a class="hash-link" href="#missing-sourcessinks" title="Direct link to heading">#</a></h4><p><code>HttpRequest.GET</code> is a common source of <code>UserControled</code> data in Django. If the
<code>request</code> objects are not explicitly typed as <code>HttpRequst</code>, however, Pysa will
fail to detect obvious issues:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">http </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> HttpRequest</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">this_is_missed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># This flow WILL NOT be found, because Pysa does not know the type of</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># &#x27;request&#x27; at this point and thus does not know &#x27;request.GET&#x27; is a source</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># (even though the type is known in &#x27;run&#x27;)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin" style="color:rgb(130, 170, 255)">eval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;command&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">this_is_caught</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># This flow WILL be found.</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin" style="color:rgb(130, 170, 255)">eval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;command&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    this_is_missed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    this_is_caught</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="incomplete-call-graph"></a>Incomplete Call Graph<a class="hash-link" href="#incomplete-call-graph" title="Direct link to heading">#</a></h4><p>Pysa relies on type information in order to build a call graph that accurately
tracks a method call of <code>foo.bar(x)</code> to the <code>def bar(self, x)</code> implementation.
Without type information on <code>bar</code>, Pysa will be unable to figure out how to
dispatch the call and the flow will be lost:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">http </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> HttpRequest</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token builtin" style="color:rgb(130, 170, 255)">eval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">this_is_missed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># This flow WILL NOT be found, because Pysa does not know the type of</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># &#x27;runner&#x27;, and thus does not know where the &#x27;run&#x27; call dispatches to</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;command&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">this_is_caught</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># This flow WILL be found.</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;command&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="globals"></a>Globals<a class="hash-link" href="#globals" title="Direct link to heading">#</a></h3><p>To allow for parallel processing, Pysa is limited in it&#x27;s ability to track taint
flows through global variables. For example, Pysa will not detect an issue in
the following code:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">user_controlled_data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">load_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    user_controlled_data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;data&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">run_command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    load_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin" style="color:rgb(130, 170, 255)">eval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">user_controlled_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The best workaround is to avoid using globals in your code. If a refactor isn&#x27;t
possible, but you do know what globals should be considered tainted, you can
explicitly declare the global tainted in your <code>.pysa</code> files.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="methodology-for-debugging-false-negatives"></a>Methodology for Debugging False Negatives<a class="hash-link" href="#methodology-for-debugging-false-negatives" title="Direct link to heading">#</a></h2><ol><li>Identify the flow you expect to see<ol><li>Source</li><li>Sink</li><li>Every function call/return that propagates the tainted data from the
source to the sink</li><li>Every variable that the tainted data passes through, within the identified
functions. This usually includes the parameter which initially received
the taint, and then 0 or more local variables that hold the tainted data
as it is transformed in some way.</li></ol></li><li>Add a <a href="/docs/pysa-tips#reveal_taintyour_variable"><code>reveal_taint</code></a> and
<a href="/docs/pysa-tips#reveal_typeyour_variable"><code>reveal_type</code></a> statement to each of
the variables identified in the previous step</li><li>Run Pysa using the same command you used when the false negative manifested,
but also include the <code>--noninteractive</code> flag (eg. <code>pyre --noninteractive
analyze</code>)</li><li>Start following the flow from source to sink in your code, and find the
corresponding output for each <code>reveal_taint</code> statement.<ul><li>Note that each time Pysa analyzes a function (could be many times), it will
dump the latest taint information, so <strong>the last instance of <code>reveal_taint</code>
output for a given line will be the most accurate and is the one you should
look at.</strong></li><li><code>reveal_taint</code> output exposes some of the <a href="/docs/pysa-implementation-details">implementation
details</a> of Pysa, by giving you <code>Revealed
forward taint</code> and <code>Revealed backward taint</code> messages. Without going into
those details, you should expect to see <em>either</em> the source name (eg.
<code>UserControlled</code>) you care about appearing in the <code>Revealed forward taint</code>
output, or the sink name (eg. <code>RemoteCodeExecution</code>) you care about in the
<code>Revealed backward taint</code> output.</li></ul><ol><li>For each <code>reveal_taint</code>, following the flow of tainted data from source to
sink, locate the output in the logs that reveals the taint (eg.
<code>integration_test.reveal_taint:20:4-20:16: Revealed forward taint for
``command``:</code>).</li><li>If you see your source or sink name in the output, then go back to 1) and
carry on with the next <code>reveal_taint</code> statement. If you <em>do not</em> see the
source or sink name, then that means the cause of the false negative is
likely between your previous <code>reveal_taint</code> and the one you&#x27;re currently
looking at. Refer to the &quot;Commom Causes of False Negatives&quot; section above
for ideas on the cause, and how to fix it.</li></ol></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="example"></a>Example<a class="hash-link" href="#example" title="Direct link to heading">#</a></h3><p>Pysa will not be able to detect a vulnerability in the following code:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">http </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> HttpResponse</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token builtin" style="color:rgb(130, 170, 255)">eval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">get_command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    command </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;command&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> command</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">execute_command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">start</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    command </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> get_command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    runner </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    execute_command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Folling the above debugging steps we identify the flow of data from beginning to
end, and add debugging statements:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">http </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> HttpResponse</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        reveal_type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        reveal_taint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token builtin" style="color:rgb(130, 170, 255)">eval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 5. User controlled data reaches the sink in here</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">get_command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    command </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;command&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 1. User controlled data originates here</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reveal_type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reveal_taint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> command</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">execute_command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reveal_type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reveal_taint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reveal_type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reveal_taint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 4. User controlled data is passed in here</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">start</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    command </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> get_command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 2. User controlled data is returned here</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reveal_type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reveal_taint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    runner </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    execute_command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 3. User controlled data is passed in here</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>See the appendix for the full output of running <code>pyre --noninteractive analyze</code> on this example.</p><p>Starting at 1), we see this in the output:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING integration_test.reveal_taint:13:4-13:16: Revealed forward taint for `command`: @integration_test.reveal_taint:11:14-11:25 -&gt; UserControlled -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING   port = None}], ComplexFeature: [], TraceLength: 0, FirstIndex: [&quot;command&quot;], FirstField: []</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING UserControlled_Payload -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING   port = None}], ComplexFeature: [], TraceLength: 0, FirstIndex: [&quot;command&quot;], FirstField: []</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING integration_test.reveal_taint:13:4-13:25: Revealed backward taint for `command`: declaration -&gt; LocalReturn -&gt; SimpleFeature: [], ComplexFeature: [(Features.Complex.ReturnAccessPath [])], TraceLength: 4611686018427387903, FirstIndex: [], FirstField: []</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Removing the timestamps and other noise gives us:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">integration_test.reveal_taint:13:4-13:16:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Revealed forward taint for `command`:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @integration_test.reveal_taint:11:14-11:25 -&gt; UserControlled -&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SimpleFeature: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      Features.Simple.LeafName {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;; port = None</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ComplexFeature: [],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    TraceLength: 0,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    FirstIndex: [&quot;command&quot;],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    FirstField: []</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    UserControlled_Payload -&gt; SimpleFeature: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      Features.Simple.LeafName {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;; port = None</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ComplexFeature: [],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    TraceLength: 0,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    FirstIndex: [&quot;command&quot;],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    FirstField: []</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">integration_test.reveal_taint:13:4-13:25:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Revealed backward taint for `command`:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    declaration -&gt; LocalReturn -&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SimpleFeature: [],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ComplexFeature: [(Features.Complex.ReturnAccessPath [])],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    TraceLength: 4611686018427387903,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    FirstIndex: [],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    FirstField: []</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>For debugging false negatives, the only portion we care about is:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Revealed forward taint for `command`:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @integration_test.reveal_taint:11:14-11:25 -&gt; UserControlled</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This confirms that on line 11 (characters 14-25), we did indeed detect that
<code>command</code> was tainted as <code>UserControlled</code>.</p><p>Moving on to 2, the <code>forward taint</code> output again tells us that we have
<code>UserControlled</code> taint on <code>command</code> at line 26 (characters 4-16).</p><p>Starting with 4, we notice that we no longer see <code>UserControlled</code> or
<code>RemoteCodeExecution</code> in our revealed forward or backwards taint:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING integration_test.reveal_taint:18:4-18:16: Revealed forward taint for `command`:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING integration_test.reveal_taint:18:4-18:25: Revealed backward taint for `command`:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This has helped us narrow down the problem to the <code>execute_command</code> function. In
the end, the problem was that we did not have type information on <code>runner</code>, so
Pysa did not know where the definition of <code>runner.run</code> was. Without knowing
where the definition was, Pysa couldn&#x27;t know that <code>run</code> containted a sink and
thus couldn&#x27;t know that <code>command</code> eventually reached that sink.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="appendix"></a>Appendix<a class="hash-link" href="#appendix" title="Direct link to heading">#</a></h2><p>Subset of the output from running <code>pyre --noninteractive analyze</code> on the
example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:31,719 [PID 3382063] PERFORMANCE Overrides recorded: 2.408138s</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:31,719 [PID 3382063] INFO Building call graph...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:34,166 [PID 3382063] PERFORMANCE Call graph built: 2.447174s</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:34,166 [PID 3382063] INFO Call graph edges: 100</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:34,166 [PID 3382063] INFO Computing overrides...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:34,311 [PID 3382063] PERFORMANCE Computed overrides: 0.144886s</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:34,311 [PID 3382063] PERFORMANCE Pre-fixpoint computation for static analysis: 7.664068s</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:34,311 [PID 3382063] INFO Analysis fixpoint started for 3075 overrides 68 functions...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:34,311 [PID 3382063] INFO Iteration #0. 3143 Callables [...]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,471 [PID 3382063] WARNING integration_test.reveal_taint:6:8-6:19: Revealed type for command: str</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,471 [PID 3382063] WARNING integration_test.reveal_taint:7:8-7:20: Revealed forward taint for `command`:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,471 [PID 3382063] WARNING</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,471 [PID 3382063] WARNING integration_test.reveal_taint:7:8-7:29: Revealed backward taint for `command`: @integration_test.reveal_taint:8:13-8:20 -&gt; RemoteCodeExecution -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;eval&quot;; port = None}], ComplexFeature: [], TraceLength: 0, FirstIndex: [], FirstField: []</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING integration_test.reveal_taint:17:4-17:15: Revealed type for command: typing.Any</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING integration_test.reveal_taint:18:4-18:16: Revealed forward taint for `command`:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING integration_test.reveal_taint:19:4-19:15: Revealed type for command: typing.Any</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING integration_test.reveal_taint:20:4-20:16: Revealed forward taint for `command`:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING integration_test.reveal_taint:20:4-20:25: Revealed backward taint for `command`:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING integration_test.reveal_taint:18:4-18:25: Revealed backward taint for `command`:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,473 [PID 3382063] WARNING integration_test.reveal_taint:12:4-12:15: Revealed type for command: str</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,473 [PID 3382063] WARNING integration_test.reveal_taint:13:4-13:16: Revealed forward taint for `command`: @integration_test.reveal_taint:11:14-11:25 -&gt; UserControlled -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,473 [PID 3382063] WARNING   port = None}], ComplexFeature: [], TraceLength: 0, FirstIndex: [&quot;command&quot;], FirstField: []</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,473 [PID 3382063] WARNING UserControlled_Payload -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,473 [PID 3382063] WARNING   port = None}], ComplexFeature: [], TraceLength: 0, FirstIndex: [&quot;command&quot;], FirstField: []</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,473 [PID 3382063] WARNING</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,473 [PID 3382063] WARNING integration_test.reveal_taint:13:4-13:25: Revealed backward taint for `command`: declaration -&gt; LocalReturn -&gt; SimpleFeature: [], ComplexFeature: [(Features.Complex.ReturnAccessPath [])], TraceLength: 4611686018427387903, FirstIndex: [], FirstField: []</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,473 [PID 3382063] WARNING</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,480 [PID 3382063] WARNING integration_test.reveal_taint:25:4-25:15: Revealed type for command: str</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,480 [PID 3382063] WARNING integration_test.reveal_taint:26:4-26:16: Revealed forward taint for `command`: via call@integration_test.reveal_taint:24:14-24:34[integration_test.reveal_taint.get_command][{ root = LocalResult; path = [] }] -&gt; UserControlled -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,480 [PID 3382063] WARNING   port = None}], ComplexFeature: [], TraceLength: 1, FirstIndex: [&quot;command&quot;], FirstField: []</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,480 [PID 3382063] WARNING UserControlled_Payload -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,480 [PID 3382063] WARNING   port = None}], ComplexFeature: [], TraceLength: 1, FirstIndex: [&quot;command&quot;], FirstField: []</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,480 [PID 3382063] WARNING</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,481 [PID 3382063] WARNING integration_test.reveal_taint:26:4-26:25: Revealed backward taint for `command`:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,481 [PID 3382063] WARNING</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,546 [PID 3382063] PERFORMANCE Expensive callables for iteration 0:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,577 [PID 3382063] INFO Iteration #0, 3143 callables, heap size 46105024 took 1.266790s</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,578 [PID 3382063] INFO Iteration #1. 3038 Callables [...]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,482 [PID 3382063] WARNING integration_test.reveal_taint:6:8-6:19: Revealed type for command: str</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,482 [PID 3382063] WARNING integration_test.reveal_taint:7:8-7:20: Revealed forward taint for `command`:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,483 [PID 3382063] WARNING</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,483 [PID 3382063] WARNING integration_test.reveal_taint:7:8-7:29: Revealed backward taint for `command`: @integration_test.reveal_taint:8:13-8:20 -&gt; RemoteCodeExecution -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;eval&quot;; port = None}], ComplexFeature: [], TraceLength: 0, FirstIndex: [], FirstField: []</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,483 [PID 3382063] WARNING</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING integration_test.reveal_taint:12:4-12:15: Revealed type for command: str</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING integration_test.reveal_taint:13:4-13:16: Revealed forward taint for `command`: @integration_test.reveal_taint:11:14-11:25 -&gt; UserControlled -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING   port = None}], ComplexFeature: [], TraceLength: 0, FirstIndex: [&quot;command&quot;], FirstField: []</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING UserControlled_Payload -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING   port = None}], ComplexFeature: [], TraceLength: 0, FirstIndex: [&quot;command&quot;], FirstField: []</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING integration_test.reveal_taint:13:4-13:25: Revealed backward taint for `command`: declaration -&gt; LocalReturn -&gt; SimpleFeature: [], ComplexFeature: [(Features.Complex.ReturnAccessPath [])], TraceLength: 4611686018427387903, FirstIndex: [], FirstField: []</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING integration_test.reveal_taint:25:4-25:15: Revealed type for command: str</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING integration_test.reveal_taint:26:4-26:16: Revealed forward taint for `command`: via call@integration_test.reveal_taint:24:14-24:34[integration_test.reveal_taint.get_command][{ root = LocalResult; path = [] }] -&gt; UserControlled -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING   port = None}], ComplexFeature: [], TraceLength: 1, FirstIndex: [&quot;command&quot;], FirstField: []</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING UserControlled_Payload -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,487 [PID 3382063] WARNING   port = None}], ComplexFeature: [], TraceLength: 1, FirstIndex: [&quot;command&quot;], FirstField: []</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,487 [PID 3382063] WARNING</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,492 [PID 3382063] WARNING integration_test.reveal_taint:26:4-26:25: Revealed backward taint for `command`:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,492 [PID 3382063] WARNING</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,552 [PID 3382063] PERFORMANCE Expensive callables for iteration 1:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,585 [PID 3382063] INFO Iteration #1, 3038 callables, heap size 46521728 took 1.007461s</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,585 [PID 3382063] INFO Iteration #2. 23 Callables [...]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:37,018 [PID 3382063] PERFORMANCE Expensive callables for iteration 2:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:37,018 [PID 3382063] INFO Iteration #2, 23 callables, heap size 46530432 took 0.432597s</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:37,018 [PID 3382063] INFO Iteration #3. 2 Callables [integration_test.string_concatenation.bad_1 (fun), integration_test.string_concatenation.bad_2 (fun)]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:37,130 [PID 3382063] PERFORMANCE Expensive callables for iteration 3:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:37,131 [PID 3382063] INFO Iteration #3, 2 callables, heap size 46532352 took 0.113038s</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:37,131 [PID 3382063] INFO Iteration #4. 0 Callables []</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:37,131 [PID 3382063] INFO Fixpoint iterations: 4</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:37,348 [PID 3382063] PERFORMANCE Analysis fixpoint complete: 3.037628s</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:37,369 [PID 3382063] PERFORMANCE Analyze: 18.289002s</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/pyre-check/tree/main/documentation/website/docs/pysa_false_negatives.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/pysa-model-dsl"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label"> Model DSL</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/pysa-coverage"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Coverage Increasing Strategies </div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#common-causes-of-false-negatives" class="table-of-contents__link">Common Causes of False Negatives</a><ul><li><a href="#missing-type-information" class="table-of-contents__link">Missing Type Information</a></li><li><a href="#globals" class="table-of-contents__link">Globals</a></li></ul></li><li><a href="#methodology-for-debugging-false-negatives" class="table-of-contents__link">Methodology for Debugging False Negatives</a><ul><li><a href="#example" class="table-of-contents__link">Example</a></li></ul></li><li><a href="#appendix" class="table-of-contents__link">Appendix</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noreferrer noopener" class="footer__link-item"><span>Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noreferrer noopener" class="footer__link-item"><span>Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="https://docusaurus.io/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="https://docusaurus.io/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright &#169; 2021 Facebook, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.6a08a8ce.js"></script>
<script src="/assets/js/main.ff581f58.js"></script>
</body>
</html>