<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-pysa-false-positives-negatives">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Debugging False Positives and False Negatives | Pyre</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://pyre-check.org/img/docusaurus.png"><meta data-rh="true" name="twitter:image" content="https://pyre-check.org/img/docusaurus.png"><meta data-rh="true" property="og:url" content="https://pyre-check.org/docs/pysa-false-positives-negatives/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Debugging False Positives and False Negatives | Pyre"><meta data-rh="true" name="description" content="False Positives occur when Pysa finds an issue that is not valid, either"><meta data-rh="true" property="og:description" content="False Positives occur when Pysa finds an issue that is not valid, either"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://pyre-check.org/docs/pysa-false-positives-negatives/"><link data-rh="true" rel="alternate" href="https://pyre-check.org/docs/pysa-false-positives-negatives/" hreflang="en"><link data-rh="true" rel="alternate" href="https://pyre-check.org/docs/pysa-false-positives-negatives/" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8CK1L365DB"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-8CK1L365DB",{})</script>




<script src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/assets/css/styles.42127f68.css">
<link rel="preload" href="/assets/js/runtime~main.244374e3.js" as="script">
<link rel="preload" href="/assets/js/main.ba1c0690.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#20232a;color:#fff" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">Support Ukraine ðŸ‡ºðŸ‡¦ <a target="_blank" rel="noopener noreferrer" href="https://opensource.fb.com/support-ukraine"> Help Provide Humanitarian Aid to Ukraine</a>.</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/integrated_logo_light.png" alt="Pyre Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/integrated_logo_light.png" alt="Pyre Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Documentation</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/getting-started/">Type Checking (Pyre)</a></li><li><a class="dropdown__link" href="/docs/pysa-basics/">Static Analysis (Pysa)</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/pyre-check" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/pysa-quickstart/">Quickstart</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/pysa-basics/">How Pysa Works</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/pysa-running/">Running Pysa</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/pysa-shipping-rules-models/">Shipping Pysa Models and Rules</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/pysa-model-generators/">Scaling Beyond Individual Models</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/user-docs/">User Docs</a><button aria-label="Toggle the collapsible sidebar category &#x27;User Docs&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/pysa-false-positives-negatives/">Debugging False Positives and False Negatives</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pysa-explore/">Exploring Taint Models Interactively</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pysa-coverage/">Coverage Increasing Strategies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pysa-tips/">General Tips</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/static-analysis-post-processor/">Static Analysis Processor</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/warning_codes/overview-public/">Warning Codes</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/pysa-additional-resources/">Additional Resources</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/user-docs/"><span itemprop="name">User Docs</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Debugging False Positives and False Negatives</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Debugging False Positives and False Negatives</h1></header><p><strong>False Positives</strong> occur when Pysa finds an issue that is not valid, either
because the flow cannot actually happen or because it is not a security risk.</p><p><strong>False Negatives</strong> occur when there is a legitimate flow of tainted data from a
source to a sink, but Pysa fails to catch it.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="common-causes-of-false-positives">Common Causes of False Positives<a class="hash-link" href="#common-causes-of-false-positives" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="taint-broadening">Taint broadening<a class="hash-link" href="#taint-broadening" title="Direct link to heading">â€‹</a></h3><p>Pysa uses a set of heuristics in order to make the analysis scale to millions of
lines of code. The main heuristic is called
<a href="/docs/pysa-advanced/#taint-broadening"><strong>taint broadening</strong></a> (also called <strong>taint
collapsing</strong>), which happens when Pysa is tracking too many attributes of an
object or keys of a dictionary.</p><p>To avoid blowing up, Pysa will collapse taint, and assume the whole object is
tainted. Pysa will use sane defaults, but heuristics can be
<a href="/docs/pysa-advanced/##analysis-thresholds">tuned using command line options or a taint configuration file</a>.</p><p>Taint collapsing also happens when taint flows through a function that Pysa does
not have the code for. To be sound, it assumes functions without code
automatically propagate taint on arguments to their return value. This can be
avoided by providing a model for these functions using
<a href="/docs/pysa-advanced/##obscure-models"><code>@SkipObscure</code></a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="common-causes-of-false-negatives">Common Causes of False Negatives<a class="hash-link" href="#common-causes-of-false-negatives" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="missing-type-information">Missing Type Information<a class="hash-link" href="#missing-type-information" title="Direct link to heading">â€‹</a></h3><p>Pysa relies on type information from Pyre to identify sources and sinks, and to
build the call graph needed to follow the propagation of taint between the two.
Just because type information is available <em>somewhere</em> in the code, does not
mean Pyre will know the type of an object in the exact place where Pysa needs
it. See the documentation on
<a href="/docs/pysa-coverage/">Coverage Increasing Strategies</a> for tips on how to
increase type coverage. The following examples demonstrate how lost type
information leads to lost flows.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="missing-sourcessinks">Missing Sources/Sinks<a class="hash-link" href="#missing-sourcessinks" title="Direct link to heading">â€‹</a></h4><p><code>HttpRequest.GET</code> is a common source of <code>UserControlled</code> data in Django. If the
<code>request</code> objects are not explicitly typed as <code>HttpRequest</code>, however, Pysa will
fail to detect obvious issues:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">http </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> HttpRequest</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">this_is_missed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># This flow WILL NOT be found, because Pysa does not know the type of</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># &#x27;request&#x27; at this point and thus does not know &#x27;request.GET&#x27; is a source</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># (even though the type is known in &#x27;run&#x27;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin" style="color:rgb(130, 170, 255)">eval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;command&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">this_is_caught</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># This flow WILL be found.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin" style="color:rgb(130, 170, 255)">eval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;command&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    this_is_missed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    this_is_caught</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="incomplete-call-graph">Incomplete Call Graph<a class="hash-link" href="#incomplete-call-graph" title="Direct link to heading">â€‹</a></h4><p>Pysa relies on type information in order to build a call graph that accurately
tracks a method call of <code>foo.bar(x)</code> to the <code>def bar(self, x)</code> implementation.
Without type information on <code>bar</code>, Pysa will be unable to figure out how to
dispatch the call and the flow will be lost:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">http </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> HttpRequest</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token builtin" style="color:rgb(130, 170, 255)">eval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">this_is_missed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># This flow WILL NOT be found, because Pysa does not know the type of</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># &#x27;runner&#x27;, and thus does not know where the &#x27;run&#x27; call dispatches to</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;command&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">this_is_caught</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># This flow WILL be found.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;command&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="globals">Globals<a class="hash-link" href="#globals" title="Direct link to heading">â€‹</a></h3><p>To allow for parallel processing, Pysa is limited in it&#x27;s ability to track taint
flows through global variables. For example, Pysa will not detect an issue in
the following code:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">user_controlled_data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">load_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    user_controlled_data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;data&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">run_command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    load_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin" style="color:rgb(130, 170, 255)">eval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">user_controlled_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The best workaround is to avoid using globals in your code. If a refactor isn&#x27;t
possible, but you do know what globals should be considered tainted, you can
explicitly declare the global tainted in your <code>.pysa</code> files.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="methodology-for-debugging-false-positives-and-false-negatives">Methodology for Debugging False Positives and False Negatives<a class="hash-link" href="#methodology-for-debugging-false-positives-and-false-negatives" title="Direct link to heading">â€‹</a></h2><p>There are three recommended ways to debug false positives and false negatives.</p><p>If the analysis is reasonably fast on your code, or that you are able to
reproduce the false positive or false negative on a smaller code, you can use
the <a href="#reveal-taint-approach">reveal_taint</a> approach.</p><p>If, instead, the analysis is slow on your code (say, more than 5 minutes) and
that you are unable to reproduce on a small example, you can use the
<a href="#model-explorer-approach">model explorer</a> or
<a href="#sapp-summaries-approach">SAPP summaries</a> approach.</p><p>In all cases, you should first:</p><ol><li>Identify the flow you expect to see (or not see):<ul><li>Source</li><li>Sink</li><li>Every function call/return that propagates the tainted data from the source
to the sink</li><li>Every variable that the tainted data passes through, within the identified
functions. This usually includes the parameter which initially received the
taint, and then 0 or more local variables that hold the tainted data as it
is transformed in some way.</li></ul></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="reveal-taint-approach">Reveal taint approach<a class="hash-link" href="#reveal-taint-approach" title="Direct link to heading">â€‹</a></h3><p>This approach is based on the magic functions
<a href="/docs/pysa-tips/#reveal_taintyour_variable"><code>reveal_taint</code></a> and
<a href="/docs/pysa-tips/#reveal_typeyour_variable"><code>reveal_type</code></a>.</p><ol start="2"><li>Add a <code>reveal_taint</code> and <code>reveal_type</code> statement to each of the variables
that must be tainted (or not), as identified in step 1.</li><li>Start following the flow from source to sink in your code, and find the
corresponding output for each <code>reveal_taint</code> statement.<ul><li>Note that each time Pysa analyzes a function (could be many times), it will
dump the latest taint information, so <strong>the last instance of <code>reveal_taint</code>
output for a given line will be the most accurate and is the one you should
look at.</strong></li><li><code>reveal_taint</code> output exposes some of the
<a href="/docs/pysa-implementation-details/">implementation details</a> of Pysa, by giving
you <code>Revealed forward taint</code> and <code>Revealed backward taint</code> messages.
Without going into those details, you should expect to see <em>either</em> the
source name (eg. <code>UserControlled</code>) you care about appearing in the
<code>Revealed forward taint</code> output, or the sink name (eg.
<code>RemoteCodeExecution</code>) you care about in the <code>Revealed backward taint</code>
output.</li><li>For each <code>reveal_taint</code>, following the flow of tainted data from source to
sink, locate the output in the logs that reveals the taint (eg.
<code>integration_test.reveal_taint:20:4-20:16: Revealed forward taint for ``command``:</code>).</li><li>If you see your source or sink name in the output, then go back to 1) and
carry on with the next <code>reveal_taint</code> statement. If you <em>do not</em> see the
source or sink name, then that means the cause of the false negative is
likely between your previous <code>reveal_taint</code> and the one you&#x27;re currently
looking at. Refer to the &quot;Commom Causes of False Negatives&quot; section above
for ideas on the cause, and how to fix it.</li></ul></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="model-explorer-approach">Model explorer approach<a class="hash-link" href="#model-explorer-approach" title="Direct link to heading">â€‹</a></h3><p>This approach uses the <a href="/docs/pysa-explore/">Pysa Model Explorer</a> to interactively
explore the taint output results.</p><ol start="2"><li>Perform a full run using the <code>--save-results-to</code> parameters.</li><li>Start the <a href="/docs/pysa-explore/">Pysa Model Explorer</a>. For each function or method
identified in step 1, retrieve the fully qualified name of the callable using
<code>callables_containing</code>, then use <code>print_model(&lt;fully-qualified-name&gt;)</code>.<ul><li>If the return variable should be tainted, you should see a source on the
<code>result</code> port.</li><li>If an argument should be tainted, you should see a sink on a port named
<code>formal(&lt;argument-name&gt;)</code>.</li><li>This should allow you to figure out in which callable the taint is
incorrectly lost (for a false negative) or where the taint is incorrectly
kept (for a false positive).</li><li>If you still don&#x27;t know what is wrong, you can try to add a
<a href="/docs/pysa-tips/#pyre_dump"><code>pyre_dump</code></a> call in a given callable, and run
pysa again. This will produce very verbose logs, which might be hard to
navigate.</li></ul></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sapp-summaries-approach">SAPP summaries approach<a class="hash-link" href="#sapp-summaries-approach" title="Direct link to heading">â€‹</a></h3><p>This approach uses the
<a href="https://www.internalfb.com/intern/wiki/Product_Security/ProdSec_Internal/Tools/Zoncolan/Security_Engineers/SAPP_Summary_Explorer_-_VS_Code_Extension/" target="_blank" rel="noopener noreferrer">SAPP Summaries Explorer</a>
to interactively explore the taint output results. The approach is the same as
&quot;Model explorer approach&quot; but can be done in a graphical way.</p><ol><li><p><strong>Upload SAPP Summary for the run which the issue belongs to</strong>: Click on the
arrow on the top right of the SAPP UI Run page and click Upload Run.</p><img loading="lazy" alt="Upload SAPP summaries" src="/img/fb/upload_sapp_summaries.png" class="img_ev3q"></li><li><p><strong>Open SAPP Summaries Web UI</strong>: After a while refresh the run page and you
should see <code>Available: Load in VS Code or View on Web</code>. Click on the View on
Web link which brings you to a UI where you&#x27;ll insert the fully qualified
domain name of the functions you want to review</p></li><li><p><strong>Identify the frame/function where the taint flow was interrupted reviewing
the sink trace</strong>: Start from the sink (last frame) and use SAPP Summary check
if the last frame function has the correct taint associated with the correct
parameter (<code>formal</code>). For example in
(this)<!-- -->[https://fburl.com/security/4dmlih2v]<!-- --> issue check in SAPP Summary if in
<code>weather.service.WeatherAPIService.async_current_weather_api_json</code> <code>sinks</code>
list the parameter <code>self[lng]</code> is tainted with the sink kind we want to track
in the issue (in our example <code>HTTPClientRequestSchematized_URI</code>). If this is
the case repeat the same process for the next frame
(<code>weather.service.WeatherAPIService._async_get_current_weather_from_api </code>)
until reaching a function which does not propagate the taint correctly (move
to point 5) or the Trace Root Callable (move to point 4).</p><img loading="lazy" alt="Upload SAPP summaries" src="/img/fb/sapp_summaries_sink_trace.png" class="img_ev3q"></li><li><p><strong>Identify the frame/function where the taint flow was interrupted reviewing
the source trace</strong>: Apply the same process starting from the source and
checking the correct taint propagation in the <code>result</code> value of SAPP summary
(value returned by the function). Example
(issue)<!-- -->[https://fburl.com/security/dh4wowfm]<!-- --> we start from
<code>users.user_phone_fetcher.UserPhoneFetcher.async_get_phone_number_node</code>
(which is the first frame) and check if SAPP summary is correctly showing the
<code>NodeEdgeGetter</code> source in the <code>result</code> port (which represent the return
value of the function). If this is the case repeat the same process for the
next frame until reaching a function which does not propagate the taint
correctly.</p><img loading="lazy" alt="Upload SAPP summaries" src="/img/fb/sapp_summaries_source_trace.png" class="img_ev3q"></li><li><p><strong>Identify the root cause</strong>:</p></li></ol><ul><li>Check recent changes to the code which may have altered Pysa ability to track
the taint or simply deleted the flow</li><li>Manually review the code and see if there are patterns described in
<a href="#common-causes-of-false-negatives">common causes of false negatives</a> or in
open pysa false negatives/false positive tasks (tags <code>pysa-bug</code> and
<code>false-negative</code>/<code>false-positive</code> or child tasks of <a href="https://internalfb.com/T145051608" target="_blank" rel="noopener noreferrer">T145051608</a>).</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-using-reveal_taint">Example using <code>reveal_taint</code><a class="hash-link" href="#example-using-reveal_taint" title="Direct link to heading">â€‹</a></h3><p>Pysa will not be able to detect a vulnerability in the following code:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">http </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> HttpResponse</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token builtin" style="color:rgb(130, 170, 255)">eval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">get_command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    command </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;command&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> command</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">execute_command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">start</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    command </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> get_command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    runner </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    execute_command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Folling the above debugging steps we identify the flow of data from beginning to
end, and add debugging statements:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">http </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> HttpResponse</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        reveal_type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        reveal_taint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token builtin" style="color:rgb(130, 170, 255)">eval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 5. User controlled data reaches the sink in here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">get_command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    command </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">GET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;command&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 1. User controlled data originates here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reveal_type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reveal_taint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> command</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">execute_command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reveal_type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reveal_taint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reveal_type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reveal_taint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 4. User controlled data is passed in here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">start</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> HttpRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    command </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> get_command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 2. User controlled data is returned here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reveal_type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reveal_taint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    runner </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    execute_command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">runner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 3. User controlled data is passed in here</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>See the appendix for the full output of running <code>pyre --noninteractive analyze</code>
on this example.</p><p>Starting at 1), we see this in the output:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING integration_test.reveal_taint:13:4-13:16: Revealed forward taint for `command`: @integration_test.reveal_taint:11:14-11:25 -&gt; UserControlled -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING   port = None}], ComplexFeature: [], TraceLength: 0, FirstIndex: [&quot;command&quot;], FirstField: []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING UserControlled_Payload -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING   port = None}], ComplexFeature: [], TraceLength: 0, FirstIndex: [&quot;command&quot;], FirstField: []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING integration_test.reveal_taint:13:4-13:25: Revealed backward taint for `command`: declaration -&gt; LocalReturn -&gt; SimpleFeature: [], ComplexFeature: [(Features.Complex.ReturnAccessPath [])], TraceLength: 4611686018427387903, FirstIndex: [], FirstField: []</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Removing the timestamps and other noise gives us:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">integration_test.reveal_taint:13:4-13:16:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Revealed forward taint for `command`:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @integration_test.reveal_taint:11:14-11:25 -&gt; UserControlled -&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SimpleFeature: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      Features.Simple.LeafName {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;; port = None</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ComplexFeature: [],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    TraceLength: 0,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    FirstIndex: [&quot;command&quot;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    FirstField: []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    UserControlled_Payload -&gt; SimpleFeature: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      Features.Simple.LeafName {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;; port = None</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ComplexFeature: [],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    TraceLength: 0,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    FirstIndex: [&quot;command&quot;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    FirstField: []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">integration_test.reveal_taint:13:4-13:25:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Revealed backward taint for `command`:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    declaration -&gt; LocalReturn -&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SimpleFeature: [],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ComplexFeature: [(Features.Complex.ReturnAccessPath [])],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    TraceLength: 4611686018427387903,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    FirstIndex: [],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    FirstField: []</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For debugging false negatives, the only portion we care about is:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Revealed forward taint for `command`:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @integration_test.reveal_taint:11:14-11:25 -&gt; UserControlled</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This confirms that on line 11 (characters 14-25), we did indeed detect that
<code>command</code> was tainted as <code>UserControlled</code>.</p><p>Moving on to 2, the <code>forward taint</code> output again tells us that we have
<code>UserControlled</code> taint on <code>command</code> at line 26 (characters 4-16).</p><p>Starting with 4, we notice that we no longer see <code>UserControlled</code> or
<code>RemoteCodeExecution</code> in our revealed forward or backwards taint:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING integration_test.reveal_taint:18:4-18:16: Revealed forward taint for `command`:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING integration_test.reveal_taint:18:4-18:25: Revealed backward taint for `command`:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This has helped us narrow down the problem to the <code>execute_command</code> function. In
the end, the problem was that we did not have type information on <code>runner</code>, so
Pysa did not know where the definition of <code>runner.run</code> was. Without knowing
where the definition was, Pysa couldn&#x27;t know that <code>run</code> containted a sink and
thus couldn&#x27;t know that <code>command</code> eventually reached that sink.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="appendix">Appendix<a class="hash-link" href="#appendix" title="Direct link to heading">â€‹</a></h2><p>Subset of the output from running <code>pyre --noninteractive analyze</code> on the
example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:31,719 [PID 3382063] PERFORMANCE Overrides recorded: 2.408138s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:31,719 [PID 3382063] INFO Building call graph...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:34,166 [PID 3382063] PERFORMANCE Call graph built: 2.447174s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:34,166 [PID 3382063] INFO Call graph edges: 100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:34,166 [PID 3382063] INFO Computing overrides...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:34,311 [PID 3382063] PERFORMANCE Computed overrides: 0.144886s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:34,311 [PID 3382063] PERFORMANCE Pre-fixpoint computation for static analysis: 7.664068s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:34,311 [PID 3382063] INFO Analysis fixpoint started for 3075 overrides 68 functions...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:34,311 [PID 3382063] INFO Iteration #0. 3143 Callables [...]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,471 [PID 3382063] WARNING integration_test.reveal_taint:6:8-6:19: Revealed type for command: str</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,471 [PID 3382063] WARNING integration_test.reveal_taint:7:8-7:20: Revealed forward taint for `command`:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,471 [PID 3382063] WARNING</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,471 [PID 3382063] WARNING integration_test.reveal_taint:7:8-7:29: Revealed backward taint for `command`: @integration_test.reveal_taint:8:13-8:20 -&gt; RemoteCodeExecution -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;eval&quot;; port = None}], ComplexFeature: [], TraceLength: 0, FirstIndex: [], FirstField: []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING integration_test.reveal_taint:17:4-17:15: Revealed type for command: typing.Any</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING integration_test.reveal_taint:18:4-18:16: Revealed forward taint for `command`:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING integration_test.reveal_taint:19:4-19:15: Revealed type for command: typing.Any</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING integration_test.reveal_taint:20:4-20:16: Revealed forward taint for `command`:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING integration_test.reveal_taint:20:4-20:25: Revealed backward taint for `command`:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING integration_test.reveal_taint:18:4-18:25: Revealed backward taint for `command`:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,472 [PID 3382063] WARNING</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,473 [PID 3382063] WARNING integration_test.reveal_taint:12:4-12:15: Revealed type for command: str</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,473 [PID 3382063] WARNING integration_test.reveal_taint:13:4-13:16: Revealed forward taint for `command`: @integration_test.reveal_taint:11:14-11:25 -&gt; UserControlled -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,473 [PID 3382063] WARNING   port = None}], ComplexFeature: [], TraceLength: 0, FirstIndex: [&quot;command&quot;], FirstField: []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,473 [PID 3382063] WARNING UserControlled_Payload -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,473 [PID 3382063] WARNING   port = None}], ComplexFeature: [], TraceLength: 0, FirstIndex: [&quot;command&quot;], FirstField: []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,473 [PID 3382063] WARNING</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,473 [PID 3382063] WARNING integration_test.reveal_taint:13:4-13:25: Revealed backward taint for `command`: declaration -&gt; LocalReturn -&gt; SimpleFeature: [], ComplexFeature: [(Features.Complex.ReturnAccessPath [])], TraceLength: 4611686018427387903, FirstIndex: [], FirstField: []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,473 [PID 3382063] WARNING</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,480 [PID 3382063] WARNING integration_test.reveal_taint:25:4-25:15: Revealed type for command: str</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,480 [PID 3382063] WARNING integration_test.reveal_taint:26:4-26:16: Revealed forward taint for `command`: via call@integration_test.reveal_taint:24:14-24:34[integration_test.reveal_taint.get_command][{ root = LocalResult; path = [] }] -&gt; UserControlled -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,480 [PID 3382063] WARNING   port = None}], ComplexFeature: [], TraceLength: 1, FirstIndex: [&quot;command&quot;], FirstField: []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,480 [PID 3382063] WARNING UserControlled_Payload -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,480 [PID 3382063] WARNING   port = None}], ComplexFeature: [], TraceLength: 1, FirstIndex: [&quot;command&quot;], FirstField: []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,480 [PID 3382063] WARNING</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,481 [PID 3382063] WARNING integration_test.reveal_taint:26:4-26:25: Revealed backward taint for `command`:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,481 [PID 3382063] WARNING</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,546 [PID 3382063] PERFORMANCE Expensive callables for iteration 0:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,577 [PID 3382063] INFO Iteration #0, 3143 callables, heap size 46105024 took 1.266790s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:35,578 [PID 3382063] INFO Iteration #1. 3038 Callables [...]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,482 [PID 3382063] WARNING integration_test.reveal_taint:6:8-6:19: Revealed type for command: str</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,482 [PID 3382063] WARNING integration_test.reveal_taint:7:8-7:20: Revealed forward taint for `command`:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,483 [PID 3382063] WARNING</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,483 [PID 3382063] WARNING integration_test.reveal_taint:7:8-7:29: Revealed backward taint for `command`: @integration_test.reveal_taint:8:13-8:20 -&gt; RemoteCodeExecution -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;eval&quot;; port = None}], ComplexFeature: [], TraceLength: 0, FirstIndex: [], FirstField: []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,483 [PID 3382063] WARNING</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING integration_test.reveal_taint:12:4-12:15: Revealed type for command: str</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING integration_test.reveal_taint:13:4-13:16: Revealed forward taint for `command`: @integration_test.reveal_taint:11:14-11:25 -&gt; UserControlled -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING   port = None}], ComplexFeature: [], TraceLength: 0, FirstIndex: [&quot;command&quot;], FirstField: []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING UserControlled_Payload -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING   port = None}], ComplexFeature: [], TraceLength: 0, FirstIndex: [&quot;command&quot;], FirstField: []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING integration_test.reveal_taint:13:4-13:25: Revealed backward taint for `command`: declaration -&gt; LocalReturn -&gt; SimpleFeature: [], ComplexFeature: [(Features.Complex.ReturnAccessPath [])], TraceLength: 4611686018427387903, FirstIndex: [], FirstField: []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING integration_test.reveal_taint:25:4-25:15: Revealed type for command: str</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING integration_test.reveal_taint:26:4-26:16: Revealed forward taint for `command`: via call@integration_test.reveal_taint:24:14-24:34[integration_test.reveal_taint.get_command][{ root = LocalResult; path = [] }] -&gt; UserControlled -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING   port = None}], ComplexFeature: [], TraceLength: 1, FirstIndex: [&quot;command&quot;], FirstField: []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,486 [PID 3382063] WARNING UserControlled_Payload -&gt; SimpleFeature: [Features.Simple.LeafName {leaf = &quot;Obj{django.http.request.HttpRequest.GET}&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,487 [PID 3382063] WARNING   port = None}], ComplexFeature: [], TraceLength: 1, FirstIndex: [&quot;command&quot;], FirstField: []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,487 [PID 3382063] WARNING</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,492 [PID 3382063] WARNING integration_test.reveal_taint:26:4-26:25: Revealed backward taint for `command`:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,492 [PID 3382063] WARNING</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,552 [PID 3382063] PERFORMANCE Expensive callables for iteration 1:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,585 [PID 3382063] INFO Iteration #1, 3038 callables, heap size 46521728 took 1.007461s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:36,585 [PID 3382063] INFO Iteration #2. 23 Callables [...]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:37,018 [PID 3382063] PERFORMANCE Expensive callables for iteration 2:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:37,018 [PID 3382063] INFO Iteration #2, 23 callables, heap size 46530432 took 0.432597s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:37,018 [PID 3382063] INFO Iteration #3. 2 Callables [integration_test.string_concatenation.bad_1 (fun), integration_test.string_concatenation.bad_2 (fun)]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:37,130 [PID 3382063] PERFORMANCE Expensive callables for iteration 3:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:37,131 [PID 3382063] INFO Iteration #3, 2 callables, heap size 46532352 took 0.113038s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:37,131 [PID 3382063] INFO Iteration #4. 0 Callables []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:37,131 [PID 3382063] INFO Fixpoint iterations: 4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:37,348 [PID 3382063] PERFORMANCE Analysis fixpoint complete: 3.037628s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-28 13:02:37,369 [PID 3382063] PERFORMANCE Analyze: 18.289002s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/pyre-check/tree/main/documentation/website/docs/pysa_false_positives_negatives.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/category/user-docs/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">User Docs</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/pysa-explore/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Exploring Taint Models Interactively</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#common-causes-of-false-positives" class="table-of-contents__link toc-highlight">Common Causes of False Positives</a><ul><li><a href="#taint-broadening" class="table-of-contents__link toc-highlight">Taint broadening</a></li></ul></li><li><a href="#common-causes-of-false-negatives" class="table-of-contents__link toc-highlight">Common Causes of False Negatives</a><ul><li><a href="#missing-type-information" class="table-of-contents__link toc-highlight">Missing Type Information</a></li><li><a href="#globals" class="table-of-contents__link toc-highlight">Globals</a></li></ul></li><li><a href="#methodology-for-debugging-false-positives-and-false-negatives" class="table-of-contents__link toc-highlight">Methodology for Debugging False Positives and False Negatives</a><ul><li><a href="#reveal-taint-approach" class="table-of-contents__link toc-highlight">Reveal taint approach</a></li><li><a href="#model-explorer-approach" class="table-of-contents__link toc-highlight">Model explorer approach</a></li><li><a href="#sapp-summaries-approach" class="table-of-contents__link toc-highlight">SAPP summaries approach</a></li><li><a href="#example-using-reveal_taint" class="table-of-contents__link toc-highlight">Example using <code>reveal_taint</code></a></li></ul></li><li><a href="#appendix" class="table-of-contents__link toc-highlight">Appendix</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noreferrer noopener" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noreferrer noopener" class="footer__link-item">Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.fb.com/" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/img/meta_open_source_logo.svg" alt="Meta Open Source Logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/img/meta_open_source_logo.svg" alt="Meta Open Source Logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">Copyright &#169; 2024 Meta Platforms, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.244374e3.js"></script>
<script src="/assets/js/main.ba1c0690.js"></script>
</body>
</html>