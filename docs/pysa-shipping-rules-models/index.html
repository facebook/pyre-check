<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8CK1L365DB"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-8CK1L365DB",{})</script>
<script src="https://buttons.github.io/buttons.js"></script><title data-react-helmet="true">Shipping Pysa Models and Rules | Pyre</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://pyre-check.org/img/docusaurus.png"><meta data-react-helmet="true" name="twitter:image" content="https://pyre-check.org/img/docusaurus.png"><meta data-react-helmet="true" property="og:url" content="https://pyre-check.org/docs/pysa-shipping-rules-models/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Shipping Pysa Models and Rules | Pyre"><meta data-react-helmet="true" name="description" content="We welcome contributions and coverage improvements for Pysa! This page walks you through the basics of adding new models or rules, and testing your changes."><meta data-react-helmet="true" property="og:description" content="We welcome contributions and coverage improvements for Pysa! This page walks you through the basics of adding new models or rules, and testing your changes."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://pyre-check.org/docs/pysa-shipping-rules-models/"><link data-react-helmet="true" rel="alternate" href="https://pyre-check.org/docs/pysa-shipping-rules-models/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://pyre-check.org/docs/pysa-shipping-rules-models/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.9178da2e.css">
<link rel="preload" href="/assets/js/runtime~main.1bda509e.js" as="script">
<link rel="preload" href="/assets/js/main.4810bc3d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/integrated_logo_light.png" alt="Pyre Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/integrated_logo_light.png" alt="Pyre Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link">Documentation</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/getting-started/">Type Checking (Pyre)</a></li><li><a class="dropdown__link" href="/docs/pysa-basics/">Static Analysis (Pysa)</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/pyre-check" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/pysa-quickstart/">Quickstart</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">How Pysa Works</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/pysa-running/">Running Pysa</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/pysa-shipping-rules-models/">Shipping Pysa Models and Rules</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Scaling Beyond Individual Models</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Development Tips</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/static-analysis-post-processor/">Static Analysis Processor</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Warning Codes</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/pysa-additional-resources/">Additional Resources</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/pysa-explore/">Exploring Taint Models Interactively</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_1lV3"><div class="docItemContainer_zt2Y"><article><header><h1 class="docTitle_1y8q">Shipping Pysa Models and Rules</h1></header><div class="markdown"><p>We welcome contributions and coverage improvements for Pysa! This page walks you through the basics of adding new models or rules, and testing your changes.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="prerequisites"></a>Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">#</a></h2><p>This document assumes you:</p><ol><li>Have followed <a href="/docs/pysa-quickstart/">these instructions</a> to set up Pysa and SAPP.</li><li>Understand the <a href="/docs/pysa-basics/">basic concepts of sources, sinks, sanitizers, and
rules</a> as well as <a href="/docs/pysa-features/">features</a>.</li><li>Have completed a <a href="/docs/pysa-running/">successful run of Pysa</a></li><li>Know the sources and sinks you&#x27;d like to detect.</li></ol><p>Ideally, you will also have completed the Pysa tutorial (<a href="https://github.com/facebook/pyre-check/tree/main/documentation/pysa_tutorial" target="_blank" rel="noopener noreferrer">code</a>,
<a href="https://www.youtube.com/watch?v=8I3zlvtpOww" target="_blank" rel="noopener noreferrer">video</a>).</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="where-to-put-your-models--taintconfig-changes"></a>Where to put your models / <code>taint.config</code> changes<a class="hash-link" href="#where-to-put-your-models--taintconfig-changes" title="Direct link to heading">#</a></h2><p>Common privacy/security-related rules and models should be placed under <a href="https://github.com/facebook/pyre-check/tree/main/stubs/taint/core_privacy_security" target="_blank" rel="noopener noreferrer"><code>stubs/taint/core_privacy_security</code></a>. These should only reference entities that exist in the Python standard library, or the <a href="https://github.com/facebook/pyre-check/tree/main/stubs" target="_blank" rel="noopener noreferrer">type stubs</a> that are shipped with Pyre.</p><p>Models for third-party libraries should be placed under <a href="https://github.com/facebook/pyre-check/tree/main/stubs/third_party_taint" target="_blank" rel="noopener noreferrer"><code>stubs/third_party_taint</code></a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="writing-your-models--taintconfig-changes"></a>Writing your models / <code>taint.config</code> changes<a class="hash-link" href="#writing-your-models--taintconfig-changes" title="Direct link to heading">#</a></h2><p>Refer to the docs on <a href="/docs/pysa-basics/">sources, sinks, sanitizers, rules</a>, and
<a href="/docs/pysa-features/">features</a> when you need help. You can usually find
pre-existing examples of
<a href="https://github.com/facebook/pyre-check/blob/d82759a1f1ce5467aa2250708b226790c046f207/stubs/taint/core_privacy_security/flask_sources_sinks.pysa" target="_blank" rel="noopener noreferrer">sources</a>,
<a href="https://github.com/facebook/pyre-check/blob/d82759a1f1ce5467aa2250708b226790c046f207/stubs/taint/core_privacy_security/filesystem_sinks.pysa" target="_blank" rel="noopener noreferrer">sinks</a>,
<a href="https://github.com/facebook/pyre-check/blob/d82759a1f1ce5467aa2250708b226790c046f207/stubs/taint/core_privacy_security/sanitizers.pysa" target="_blank" rel="noopener noreferrer">sanitizers</a>,
and
<a href="https://github.com/facebook/pyre-check/blob/d82759a1f1ce5467aa2250708b226790c046f207/stubs/taint/core_privacy_security/django_sources_sinks.pysa" target="_blank" rel="noopener noreferrer">features</a>
to copy as a starting point if you get stuck.</p><p>When adding models for a pre-existing source/sink/feature type (e.g.
<a href="https://github.com/facebook/pyre-check/blob/d82759a1f1ce5467aa2250708b226790c046f207/stubs/taint/core_privacy_security/taint.config#L21" target="_blank" rel="noopener noreferrer"><code>UserControlled</code></a>,
you won&#x27;t need to modify <code>taint.config</code>. Make sure to check for pre-existing
source, sink, and feature declarations before declaring a new one; most types of
source and sinks are already declared, and it can be more sustainable to add an
additional model to an existing category, rather than creating a whole new one.</p><p>When adding a new rule, you will need to update <code>taint.config</code>. As with the
previous paragraph, try to put existing sources and sinks to use. For example,
if you&#x27;re writing a sensitive data logging rule, using the
<a href="https://github.com/facebook/pyre-check/blob/d82759a1f1ce5467aa2250708b226790c046f207/stubs/taint/core_privacy_security/taint.config#L115" target="_blank" rel="noopener noreferrer"><code>Logging</code></a>
sink will allow you to detect your chosen data flowing into many different types of loggers that we model.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="testing"></a>Testing<a class="hash-link" href="#testing" title="Direct link to heading">#</a></h2><p>Providing a quick explanation of the issue you intended to catch and evidence that the issue was caught in your local run is usually sufficient. This can be in the form of a screenshot of the issue in SAPP, a sample or paste of the <code>taint-output.json</code> produced by Pysa, etc.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="catching-known-issues"></a>Catching Known Issues<a class="hash-link" href="#catching-known-issues" title="Direct link to heading">#</a></h3><p>To test, you need to have an issue that you want to find. The best option is to
have a known vulnerability from <a href="https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=python" target="_blank" rel="noopener noreferrer">a past CVE</a>
or issue. You can manually identify the flow of data that caused the issue, make
sure you have the correct sources and sinks, and then verify that your new
rule/source/sink catches the issue.</p><p>Follow <a href="/docs/pysa-quickstart/">these instructions</a> to run Pysa and import the
results into the SAPP UI.</p><p>Once your run completes, you should be able to see the issue you intended to
catch in the UI. If there are a lot of issues showing up, you may need to use
<a href="https://pyre-check.org/docs/pysa-quickstart#run-sapp" target="_blank" rel="noopener noreferrer">filters</a> to find the
particular issue you were looking for. If you&#x27;re not finding your
issue, read through the <a href="/docs/pysa-tips/">development tips</a> for help debugging.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="integration-test"></a>Integration Test<a class="hash-link" href="#integration-test" title="Direct link to heading">#</a></h3><p>If you don&#x27;t have an existing project to test on, you can also use the integration
test environment provided with the pyre-check repo. This is a minimal, deliberately
vulnerable Flask web app. You can find all the details and instructions on how to set
it up <a href="https://github.com/facebook/pyre-check/tree/main/documentation/deliberately_vulnerable_flask_app" target="_blank" rel="noopener noreferrer">here</a>.</p><p>It should already be set up to use the taint models in the <code>pyre-check/stubs</code> folder,
so you can easily make your changes to existing Pysa models and observe the effects.</p><p>For example, suppose we wanted to add a new rule for some builtin Python functions.
We would add our new source, sink and rule in <code>stubs/taint/core_privacy_security/taint.config</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><pre tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;sources&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ...</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Foo&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;comment&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;used to annotate a foo source&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;sinks&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ...</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Bar&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;comment&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;used to annotate a bar sink&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;rules&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ...</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Foo to Bar&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;code&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">9000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;sources&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Foo&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;sinks&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Bar&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;message_format&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Data from [{$sources}] source(s) may reach [{$sinks}] sink(s)&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Make sure your new rule has a unique number and new source and sink names are also unique!</p><p>We can now add our models in a <code>.pysa</code> file under <code>stubs/taint/core_privacy_security/</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">input</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> TaintSource</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">Foo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">ascii</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">__source</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> TaintSink</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">Bar</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Then, we can open a source file in the vulnerable Flask app
(e.g. <a href="https://github.com/facebook/pyre-check/blob/d82759a1f1ce5467aa2250708b226790c046f207/documentation/deliberately_vulnerable_flask_app/app.py" target="_blank" rel="noopener noreferrer"><code>app.py</code></a>),
and inject an issue of the type we want to catch:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">alarm1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    x </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">input</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin" style="color:rgb(130, 170, 255)">ascii</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Finally, we can run the integration test using the <a href="https://github.com/facebook/pyre-check/blob/d82759a1f1ce5467aa2250708b226790c046f207/documentation/deliberately_vulnerable_flask_app/run_integration_tests.sh" target="_blank" rel="noopener noreferrer"><code>run_integration_tests.sh</code></a> script (or just run <code>pyre analyze</code>)
and verify that the issue we expect to be caught is indeed caught:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ERROR ----BEGIN PYSA INTEGRATION TEST ERROR----</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ERROR Output differs from expected:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@@ -46,5 +46,11 @@</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">+  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">+  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">+    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;code&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">9000</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">+    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;define&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;app.alarm1&quot;</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">+    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;description&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Foo to Bar [9000]: Data from [Foo] source(s) may reach [Bar] sink(s)&quot;</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">+    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;path&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;app.py&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ERROR ----END PYSA INTEGRATION TEST ERROR----</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="contributing-coverage-improvements-to-pysa"></a>Contributing Coverage Improvements to Pysa<a class="hash-link" href="#contributing-coverage-improvements-to-pysa" title="Direct link to heading">#</a></h2><p>When you&#x27;ve proven that you can catch issues with your changes, send a PR
to the <a href="https://github.com/facebook/pyre-check" target="_blank" rel="noopener noreferrer">pyre-check</a> Github repository.
Please make sure you include a test plan in your PR that follows the
<a href="#testing">testing</a> guidelines mentioned above!</p><p>If you used the <a href="https://github.com/facebook/pyre-check/tree/main/documentation/deliberately_vulnerable_flask_app" target="_blank" rel="noopener noreferrer">deliberately_vulnerable_flask_app</a> for testing, free to also
include your integration test changes with your injected issue in your PR to
help us expand our open source integration tests! Note this will require you to update the
<a href="https://github.com/facebook/pyre-check/blob/main/documentation/deliberately_vulnerable_flask_app/full_result.json" target="_blank" rel="noopener noreferrer"><code>full_result.json</code></a> file in the same folder. When you run the integration test script, a
<code>full_result.actual</code> file will be produced when the output does not match
the existing expected output. Simply copy the contents of that file to
<code>full_result.json</code>, e.g. in the example above, we would add the following lines to <code>full_result.json</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><pre tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;code&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">9000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;column&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;define&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;app.alarm1&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;description&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Foo to Bar [9000]: Data from [Foo] source(s) may reach [Bar] sink(s)&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;line&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">64</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Foo to Bar&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;path&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;app.py&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;stop_column&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">11</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;stop_line&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">64</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"></div></div><br><div class="row"><div class="col"><a href="https://github.com/facebook/pyre-check/tree/main/documentation/website/docs/pysa_shipping_rules_models.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/pysa-running/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Running Pysa</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/pysa-model-generators/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Dynamically Generating Models »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link">Prerequisites</a></li><li><a href="#where-to-put-your-models--taintconfig-changes" class="table-of-contents__link">Where to put your models / <code>taint.config</code> changes</a></li><li><a href="#writing-your-models--taintconfig-changes" class="table-of-contents__link">Writing your models / <code>taint.config</code> changes</a></li><li><a href="#testing" class="table-of-contents__link">Testing</a><ul><li><a href="#catching-known-issues" class="table-of-contents__link">Catching Known Issues</a></li><li><a href="#integration-test" class="table-of-contents__link">Integration Test</a></li></ul></li><li><a href="#contributing-coverage-improvements-to-pysa" class="table-of-contents__link">Contributing Coverage Improvements to Pysa</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noreferrer noopener" class="footer__link-item"><span>Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noreferrer noopener" class="footer__link-item"><span>Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="https://docusaurus.io/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="https://docusaurus.io/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright &#169; 2021 Facebook, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.1bda509e.js"></script>
<script src="/assets/js/main.4810bc3d.js"></script>
</body>
</html>