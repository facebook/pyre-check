def _test_sink(arg: TaintSink[Test, Via[special_sink]]): ...
def _test_source() -> TaintSource[Test, Via[special_source]]: ...

ModelQuery(
  name = "get_model_query_annotated_test1_sources",
  find = "attributes",
  where = [
      cls.fully_qualified_name.equals("model_query_annotated.Test1_C"),
      type_annotation.original.matches("^.*Annotated\[.*Color\..*]$")
    ],
  model = [
    AttributeModel(TaintSource[Test, ViaTypeOf]),
  ]
)

ModelQuery(
  name = "get_model_query_annotated_test2_sources",
  find = "attributes",
  where = [
      cls.fully_qualified_name.equals("model_query_annotated.Test2_C"),
      AnyOf(
        # Right now, type_annotation.original still uses fully qualified names due to pyre1 internals, but in the future, it won't.
        type_annotation.original.matches("^.*Annotated\[.*Optional\[float\], .*Color.RED.*\]$"),
        type_annotation.original.matches("^.*Annotated\[.*Optional\[float\], .*Color.RED, foo.*\]$")
      )
    ],
  model = [
    AttributeModel(TaintSource[Test, ViaTypeOf]),
  ]
)
